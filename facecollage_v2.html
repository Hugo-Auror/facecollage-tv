<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Face Collage TV</title>
  <style>
    /* ====== TV-friendly styling ====== */
    :root{
      --bg:#000; --fg:#e6e6e6; --accent:#6ee7ff;
      --scene-duration: 5000ms; /* default 7s between scenes */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}
    #app{position:fixed;inset:0;overflow:hidden;background:var(--bg);}

    /* Scene container uses CSS Grid for non-overlapping, irregular layout */
    .scene{
      position:absolute;inset:0;padding:2vmin;display:grid;gap:2vmin;
      grid-template-columns: repeat(10, 1fr);
      grid-auto-rows:minmax(6vmin, 1fr);
      opacity:0;transform:scale(1.02);
      transition:opacity 900ms ease, transform 1100ms ease;
    }
    .scene.active{opacity:1;transform:scale(1);}

    .face{position:relative;border-radius:2vmin;overflow:hidden;box-shadow:0 0.8vmin 3vmin rgba(0,0,0,.5);}
    .face img{width:100%;height:100%;object-fit:cover;display:block;}

    /* Size buckets map to grid spans for irregularity */
    .s{grid-column: span 2; grid-row: span 2;}
    .m{grid-column: span 3; grid-row: span 3;}
    .l{grid-column: span 4; grid-row: span 4;}
    .xl{grid-column: span 5; grid-row: span 5;}

    /* Subtle variance */
    .tilt1{transform:rotate(-1.2deg);} .tilt2{transform:rotate(0.8deg);} .tilt3{transform:rotate(-0.6deg);} .tilt4{transform:rotate(1.4deg);} 

    /* Minimal on-screen controls (hidden unless you move mouse or press Enter) */
    #controls{position:fixed;left:50%;bottom:3vmin;transform:translateX(-50%);background:rgba(20,20,20,.7);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.12);border-radius:2vmin;padding:1vmin 2vmin;display:flex;gap:1.5vmin;align-items:center;opacity:0;transition:opacity .35s;}
    #controls.visible{opacity:1}
    #controls label{font-size:1.8vmin;opacity:.85}
    #controls input[type="number"]{width:6ch;background:#111;color:#ddd;border:1px solid #333;border-radius:.8vmin;padding:.6vmin .8vmin;margin-left:.6vmin}
    #controls input[type="range"]{accent-color:var(--accent)}
    #controls button{background:var(--accent);border:none;color:#001018;font-weight:600;padding:.8vmin 1.4vmin;border-radius:1vmin;cursor:pointer}

    /* Idle cursor hidden for TV look */
    html,body{cursor:none}
    html.show-cursor, html.show-cursor body{cursor:default}

    /* Drop zone hint for uploading a JSON or CSV of image URLs */
    #dropHint{position:fixed;inset:10vmin auto auto 50%;transform:translateX(-50%);padding:1vmin 1.6vmin;border-radius:1.2vmin;background:rgba(255,255,255,.08);border:1px dashed rgba(255,255,255,.25);font-size:1.8vmin;opacity:.7}

    /* Fullscreen helper */
    #fsTip{position:fixed;top:1.2vmin;right:1.6vmin;font-size:1.6vmin;opacity:.6}
  </style>
</head>
<body>
  <div id="app"></div>
  <div id="dropHint">Drop a JSON/CSV of image URLs to load faces • Press <b>F</b> for fullscreen, <b>Enter</b> to toggle controls</div>
  <div id="fsTip"></div>

  <div id="controls" role="group" aria-label="Controls">
    <label>Min faces <input id="minFaces" type="number" min="1" max="40" value="1"></label>
    <label>Max faces <input id="maxFaces" type="number" min="1" max="40" value="5"></label>
    <label>Interval (s) <input id="interval" type="number" min="2" max="120" value="7"></label>
    <button id="shuffle">Shuffle now</button>
  </div>

  <script>
  /*
   * Face Collage TV — single-file app
   * ------------------------------------------------------------
   * HOW TO USE WITH AN ORG CHART
   * 1) Provide an array of direct image URLs in `SOURCE.images`, 
   *    OR drag & drop a JSON/CSV file containing URLs (one per row or as ["https://...", ...]).
   * 2) Host this file somewhere reachable by the TV (or open from USB on TV browsers that allow it).
   * 3) Open in the TV's browser, press F for fullscreen, and you’re done.
   *
   * SECURITY / PRIVACY NOTES
   * - Make sure image URLs are accessible to the TV but not publicly indexed if sensitive.
   * - If your org chart requires auth or an API, consider running a small internal proxy that emits an array of image URLs and enables CORS.
   *
   * OPTIONAL: Fetch from an internal endpoint returning `["url1","url2",...]`
   *   await SOURCE.loadFromEndpoint("https://intranet.example.com/org/faces.json")
   */

  const SOURCE = {
    images: [
      // Replace these placeholders with your org headshots (direct JPG/PNG URLs).
      // Example:
       "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/d79b9c81-a622-483f-a956-06eb8f1c1063?token=X19jbGRfdG9rZW5fXz1leHA9MTc2OTA0NDM0MH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZDc5YjljODEtYTYyMi00ODNmLWE5NTYtMDZlYjhmMWMxMDYzKn5obWFjPTYyZDgwYjM4ZDYyMThmMTJhYzBiOGExMDBhMTdkNGYyMjA1MzIzNmYxNDIwMWZlM2MzZmExOTc4MDE2YmJlMTc=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/3af04a1b-90b2-466c-97aa-052f79b15218?token=X19jbGRfdG9rZW5fXz1leHA9MTc3ODM3NTU0MX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmM2FmMDRhMWItOTBiMi00NjZjLTk3YWEtMDUyZjc5YjE1MjE4Kn5obWFjPTkyMmZhMTY5ODM2NTNiMDRhYzc4MjViY2Q0MTQ1NTU3YmRjMjg1NjQ5OWZhMTY4OGZlOTcyZDNlNTAwZDUwMDY=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/3b643fa3-02c6-432c-9aad-8b656be6f072?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MDU5OTUzMH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmM2I2NDNmYTMtMDJjNi00MzJjLTlhYWQtOGI2NTZiZTZmMDcyKn5obWFjPTBiNTJlNzdkNmI0OGVmNjc4MWI2YzYzNTM3NjI4MzI2YjI5MWIwMzgwNzgwM2VhZmI5NTE5NTI3MzNlZmY1ZmU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/94e4aff0-8d12-43b1-8147-2da61f5ce3e1?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MzYyMzUyM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmOTRlNGFmZjAtOGQxMi00M2IxLTgxNDctMmRhNjFmNWNlM2UxKn5obWFjPWM2ZjRjM2Y3ZTk5ZWZhMGRkOTQzOGJjZGNjY2RjMjRiMDk4YzRjZjg3NjJkZGM3MDZlYTdiMmQwMTY2OGE3OWI=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/1166ee64-b571-4ccd-8487-4dc96ce52fac?token=X19jbGRfdG9rZW5fXz1leHA9MTc2OTA0NDM0MH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMTE2NmVlNjQtYjU3MS00Y2NkLTg0ODctNGRjOTZjZTUyZmFjKn5obWFjPWQzNDA5NDhlMzk5MGQxN2JhMDAxZGRkOWUzZTA2OTNjNzRkNGMyMGVhMzg2ZjExODcwODllOWU3YmU2Y2ZmMmU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/fb40c71d-6ade-43c7-9374-5526ccb73344?token=X19jbGRfdG9rZW5fXz1leHA9MTc3Mjc1OTUyNn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZmI0MGM3MWQtNmFkZS00M2M3LTkzNzQtNTUyNmNjYjczMzQ0Kn5obWFjPTY2MDYyMjZjOTVhY2RmYmFjZjI2Njc4ODQ1OGNmMTVkYmJhNTk0ZDAzMjYxNjhjNzJlYmUxNTIxMmY3ZTYxOWI=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/eee45def-6e46-4b05-93e1-28dbf6eafcdd?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NDQ4NzU0M35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZWVlNDVkZWYtNmU0Ni00YjA1LTkzZTEtMjhkYmY2ZWFmY2RkKn5obWFjPTI0ZDJkODE4NzViYTMyNzc4ODdlM2EwN2M3ZmZmMmNmNGIwY2ZlYmJmZjljYzlkNjRiZGIxMjdhOTBmOGEyYjg=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/f852d9f7-bd15-4367-8c2d-4bdae6de7eaa?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NzIyOTkyMX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZjg1MmQ5ZjctYmQxNS00MzY3LThjMmQtNGJkYWU2ZGU3ZWFhKn5obWFjPTQwYzViOTJiMmRiNjhjMmIyOWQ1MDFjNGQ5OTI3ODIyNWZhMmRiM2Q0NDQzYTQ5MTBhYWUyZjA2YTc2ZDY0MzA=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/eb8096bd-2063-47d3-8acb-00d697982314?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NjM2NTkzMn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZWI4MDk2YmQtMjA2My00N2QzLThhY2ItMDBkNjk3OTgyMzE0Kn5obWFjPTFiZmVkMTllZDA5NTI1YWNjNGY3ZWIzZTQ4NTJlODlkOGIxYTg1OWQ2MmQ5M2YyMDNmOGY3NmM2MjlmNjkwYjE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/f134c502-8f4f-4f3b-8cbe-3a082ae13381?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NjE5MzEzM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZjEzNGM1MDItOGY0Zi00ZjNiLThjYmUtM2EwODJhZTEzMzgxKn5obWFjPTA4NWYwNmE5NjQ4ODdhYzg5OGNkN2EwOGUzNjNiMzJjYTExZjkwZjRmYzdiNzgyNjBkZTVmYTlkYzI2NThhZGQ=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/cf726b89-b07f-41da-a024-94de006968ae?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NTY5NzEyNH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmY2Y3MjZiODktYjA3Zi00MWRhLWEwMjQtOTRkZTAwNjk2OGFlKn5obWFjPTI2Y2MxNDRlNjA5MTBiNmI3NjM5ZmFmNzhlOWUyZWNmN2UwMDhlYzkyOTk2MWY3NGU2OWZiZjEzZmEwMTk4MmE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/751ef4e2-d80f-4454-802c-0b34763c3205?token=X19jbGRfdG9rZW5fXz1leHA9MTc2OTA0NDM0MH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNzUxZWY0ZTItZDgwZi00NDU0LTgwMmMtMGIzNDc2M2MzMjA1Kn5obWFjPTVlM2E4NGI3MjIxYWMxNmU1ZWM1ZDAxMDA5NjI3YmVjNTQxYTlmYTRjMTQ3ZWY5OWI0OTU3MmVlMmRjNWRhZGE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/40889e8d-f0b9-4ccd-bd3c-cb9e41749b35?token=X19jbGRfdG9rZW5fXz1leHA9MTc3Mzg4Mjc0MH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNDA4ODllOGQtZjBiOS00Y2NkLWJkM2MtY2I5ZTQxNzQ5YjM1Kn5obWFjPTJiYTJjMzQzODRlMjNkMDA0ZjU5ZTZiZTBhMzg3YTY2NjNjNDZkMjhiMWZlNjkyZGQ0Mzk3ODlmZTY1Zjc0MjM=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/37b583cc-86c0-48ef-baec-b9774041e978?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NzIyOTkyM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMzdiNTgzY2MtODZjMC00OGVmLWJhZWMtYjk3NzQwNDFlOTc4Kn5obWFjPWVlZTA2NzkwMzczMDUyY2M4ZjgyOGZjZTIxYmVkY2EyMmY0Y2U4NzZhNjZkZGM3NWI3YzAxODU3NmJhYzQwYjE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/7897ccba-2eb2-4a9d-87bb-671d631932c3?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NTI0Mjc1OH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNzg5N2NjYmEtMmViMi00YTlkLTg3YmItNjcxZDYzMTkzMmMzKn5obWFjPWFlMjczNmU0NDEwMTJiZGY2NjhhMTQ3MWJkMGIxZDJlYWFiMzc0MjI5ZGE1YmYwY2YxNzBiNzhhZmQ5M2YyZTk=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/ccccb708-10ce-48dc-b714-93429ac4e47f?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NTUxMjQ4M35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmY2NjY2I3MDgtMTBjZS00OGRjLWI3MTQtOTM0MjlhYzRlNDdmKn5obWFjPTJiN2E3ZTYwNGRlN2FjMDUzM2ZhYmNmNWNiMjFiOWY1ZDM2NWNjNWM2MzhkZGE1OTNiZTQwZTczMDhlMGVjNjY=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/25d44e60-1bd9-48cb-8b6d-a8d6220e10d1?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NzY4NDM1NH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMjVkNDRlNjAtMWJkOS00OGNiLThiNmQtYThkNjIyMGUxMGQxKn5obWFjPWMxMzk2YjJiYzkyYzFkZTllYTEwZTZmOWE0ZWQ2YTdhNzQ2MmQ0YjM3OGNhZDJiOWU5YTMxOGNhMTQ0NjA5MmU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/e50332ee-c5af-444e-888d-508f4b8e67b7?token=X19jbGRfdG9rZW5fXz1leHA9MTc2ODY5ODcyMn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZTUwMzMyZWUtYzVhZi00NDRlLTg4OGQtNTA4ZjRiOGU2N2I3Kn5obWFjPTg1OTA3ODVkN2QwZTIyOTQ4OGYxNzNkYzU1Y2E5NDBjMmI2ZTE0MjQ3OGU4N2VhNjZhM2VkYWUzNzM1NDI4MzU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/c410a352-a078-48dd-b828-bb58c8a959a2?token=X19jbGRfdG9rZW5fXz1leHA9MTc2Mzg2MDMyN35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYzQxMGEzNTItYTA3OC00OGRkLWI4MjgtYmI1OGM4YTk1OWEyKn5obWFjPThiYzNhMzYwNDZjODY0MGM5ZWQ3MmRlMTk1MWU2NDJkNWMxYzVlOWNkNzgzODBiMWE1M2MzNzZhZWFkYzBmNmQ=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/74efd30c-b5f1-4cc9-95c0-4ce049eb0bf5?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NzUxNTA0OH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNzRlZmQzMGMtYjVmMS00Y2M5LTk1YzAtNGNlMDQ5ZWIwYmY1Kn5obWFjPTdjMDQ1ZTY3OGI0MzZiMDY3ZTNiOTE0ZDlmNTFjYzgwZjcwZDFiYTVlNGE3MzIwYmE0MGRiYTcwOTU4NjE5M2M=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/494a4fbe-8d20-44d0-98d0-512774c61e04?token=X19jbGRfdG9rZW5fXz1leHA9MTc2OTA0NDM0MH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNDk0YTRmYmUtOGQyMC00NGQwLTk4ZDAtNTEyNzc0YzYxZTA0Kn5obWFjPWY3NThhMThhY2VhYjAzNzMwNjhmYTUyMzIyOTRmZTk5MzdmZDc1ZjA3YWRjYjE0ZDNjZTExOGUyMzdiMzdjOWM=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/b72f88b1-7ca2-4f4a-a653-916a3dcdf058?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NjUzODc0NX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYjcyZjg4YjEtN2NhMi00ZjRhLWE2NTMtOTE2YTNkY2RmMDU4Kn5obWFjPTY4ZWJlNDk3MWU2OGEyMjZhNjAzNjQ3OWU2Y2RkZDI3OTRmMWZiMzBkYmQxOGNiNzlhZjIyZTQyNjRjYWU3ZDc=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/8e01c2e4-c6a8-45c5-b61f-85fb89606092?token=X19jbGRfdG9rZW5fXz1leHA9MTc2ODY5ODcyMn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmOGUwMWMyZTQtYzZhOC00NWM1LWI2MWYtODVmYjg5NjA2MDkyKn5obWFjPWFhNDliNzU5MWVhMTdmODBhYmUxMjBmNTExNDIwZDFlOWI3YTE5MGZmZjVjZjhiMzEwOTUwZmNlNGI3ODg0MzA=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/e669aab3-c085-4d5d-9e63-fa51f16ba989?token=X19jbGRfdG9rZW5fXz1leHA9MTc2ODk1NzkyM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZTY2OWFhYjMtYzA4NS00ZDVkLTllNjMtZmE1MWYxNmJhOTg5Kn5obWFjPTBkY2U1NjdhYjdjODgzODM1OGY5OGUxMTg0OTg5NWYwYzg1NDcwNDM2OGRkOTMyZWEwYTk2Y2EzYmM1NzhiMzE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/aa394e2c-673b-40a8-952a-df44e497d157?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NzkyMTE0Mn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYWEzOTRlMmMtNjczYi00MGE4LTk1MmEtZGY0NGU0OTdkMTU3Kn5obWFjPWQ2YWJjOTk3OWVlNDI1MDY3NjBhNGNiODIwNGYyZjcyZmQwZWZhNjA4NDRiMmM4YTQzODQ3ZTM3YzBlM2M0ODc=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/e24ccc6e-9138-4667-b482-144a06666a99?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NTA2OTk1M35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZTI0Y2NjNmUtOTEzOC00NjY3LWI0ODItMTQ0YTA2NjY2YTk5Kn5obWFjPTI4ZWU2ZjJiZWZjZDZkNDJhZGRhNjhjNWNiZmZjOTc3MTlkNTUwY2NiZjI4OTY0MGU0ZjA4ZmVmNmQ3MzY2NTI=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/845659eb-078e-44be-8c87-cea08ea57621?token=X19jbGRfdG9rZW5fXz1leHA9MTc3ODIwMjczNn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmODQ1NjU5ZWItMDc4ZS00NGJlLThjODctY2VhMDhlYTU3NjIxKn5obWFjPTNlZDM3ZWM5ZmJjOGNmYzdhYmJjMGY1ODIyYjA0MGY3NTgxNzhhYzgyOTA5OGI4M2RiOWZhNWNiNDE2ZjU5NTM=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/04eef5f3-f8e1-445a-8c74-1d94ca68a169?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NTYxMDcyN35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMDRlZWY1ZjMtZjhlMS00NDVhLThjNzQtMWQ5NGNhNjhhMTY5Kn5obWFjPTMyMzM1ZmNlOWU1NzI1MWIxNzE1NGQ1ZWZjYmFjNjA2YTQ0N2IyYzZkMDFjZDFmM2FkOGI1NmNhNTIzMWVkMzg=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/39792ccf-8142-4983-b433-6cd25198c802?token=X19jbGRfdG9rZW5fXz1leHA9MTc2ODAwMTc3M35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMzk3OTJjY2YtODE0Mi00OTgzLWI0MzMtNmNkMjUxOThjODAyKn5obWFjPTAzYmIzN2E3N2M3NjExYWMwNmIwMDdjOGY0NjdlMzQ2ZDI2OGM5MTNiMmFjYmI3MmE5ZGQ5NDExMjMxY2JmZWU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/2795aa9e-4d34-4782-9ad0-cdcc3a1fef1f?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MDc3MjM1NH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMjc5NWFhOWUtNGQzNC00NzgyLTlhZDAtY2RjYzNhMWZlZjFmKn5obWFjPWEwY2VkYTBlY2QwZWM2N2JjNTcwNTE5N2Y1ZDRkZjdjNjBmYjczMjAxMWRlZjFjN2MyYWUyM2VhZjAyM2JjY2Y=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/642b0958-e0e6-431a-88ca-bc8b03ee65a5?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MzUzNzE0Nn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNjQyYjA5NTgtZTBlNi00MzFhLTg4Y2EtYmM4YjAzZWU2NWE1Kn5obWFjPWNkNjkwZWQ0NjY4MzM5MTM0NDA0MTA0YzE1YzIxMDA5N2E4ZjQ2NGMzZTJiZTFjNDY2YTZkZDg1MzRhYmU5YTU=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/a5afd5af-da4a-4600-a057-09038e436207?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MjI0MTEzMX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYTVhZmQ1YWYtZGE0YS00NjAwLWEwNTctMDkwMzhlNDM2MjA3Kn5obWFjPTQxM2Q1MDNlZTVjM2EzYmNhMzk3ZjhmZWMzOTRiNjZhZTg3Y2ZiY2U5NzJiNWIwMmVlYmViNzk0NjBiZTJjNzk=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/e7c5f6ae-357b-4686-bc24-b9bac41ef028?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MTIwNDMyNn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZTdjNWY2YWUtMzU3Yi00Njg2LWJjMjQtYjliYWM0MWVmMDI4Kn5obWFjPWQ3ZGFmMjkzODIzYWUxNTQ3MTg2OGI2YWRjNDkzYzU3ZTYxOTEyYmIzMDBlMDRiZjEzZjJmNTA3ZTkwMDU4M2Q=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/13bb4e35-d8d6-443e-aa4f-8a2db4d50e8c?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MDA4MTEzNX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMTNiYjRlMzUtZDhkNi00NDNlLWFhNGYtOGEyZGI0ZDUwZThjKn5obWFjPWU4NThiMzcwOWM0ODMxNjFhOTg3NjU3MjBhMGFmNDEwNjJjMDkyOTIzMmE3ZTFiMmQ5MGVjNzY4MTgzODFhN2U=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/592fcfe1-1bec-4f7f-8fe4-045c075d7549?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NDE0MTkyNn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNTkyZmNmZTEtMWJlYy00ZjdmLThmZTQtMDQ1YzA3NWQ3NTQ5Kn5obWFjPTNmMDgyNjcyODg4YzdjZGQyZTgyZGRhNDMwOGQ0YzQ1YTdiYzVkMTYzODg5OGFkZjFiZDQ3N2UzZWI0ZjAxZDc=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/12c4f4c7-d3d7-4a86-bb73-7b9aa42012c7?token=X19jbGRfdG9rZW5fXz1leHA9MTc2OTA0NDQwM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmMTJjNGY0YzctZDNkNy00YTg2LWJiNzMtN2I5YWE0MjAxMmM3Kn5obWFjPWQzNTU2MjkzNTRhNTBjYjA4YzVlZWUyMjMxYTViNmRiNDJhMzU0MWI3NTcwYTk0ZTlkNjFhOGY3MmE4MGFlMDM=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/52ad4f90-11b8-443e-a889-995b2e5c252b?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NTAwNTkyNX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmNTJhZDRmOTAtMTFiOC00NDNlLWE4ODktOTk1YjJlNWMyNTJiKn5obWFjPWJmMjdhNDRmYjQzZDM4YmNiNGQzNTI3MGNlYmFmYzBkNDQyNDE1Mzg5MGVhZmZmOTRjN2Y4NDQwZThkZjcwMTI=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/864f4660-afad-4b27-b2ff-7882802f5256?token=X19jbGRfdG9rZW5fXz1leHA9MTc2MzYwMTEzMH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmODY0ZjQ2NjAtYWZhZC00YjI3LWIyZmYtNzg4MjgwMmY1MjU2Kn5obWFjPTgzZmFkM2NiNjQ0YzVjYjljNzMyMDY2ZTJmNWRlMjE1MmE2MDFjYTA0NzY4YjFmMTMyNTk4MTE1MzE2NmE2M2M=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/cdb82a23-6978-4285-9479-ac68da7c65b3?token=X19jbGRfdG9rZW5fXz1leHA9MTc2ODM1MzEzM35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmY2RiODJhMjMtNjk3OC00Mjg1LTk0NzktYWM2OGRhN2M2NWIzKn5obWFjPWEyMmQ2MzRmMTBmMzdiNTVmZjc1NTI0YTA2NmU4Y2ViNDdmYzBlMjg5NTM1YTY1NmJhMGE3YmJmYWE2ZGUxYWE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/aef562c7-4d84-4afe-a553-acb3ec9acaab?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NzkyMTE1M35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYWVmNTYyYzctNGQ4NC00YWZlLWE1NTMtYWNiM2VjOWFjYWFiKn5obWFjPWM5NmIzZGIxOGMwYmY4NTA5NzdkY2M5ZGQ0YWQ0YzNkMWFmMjAxNGI1ODljYjVlNzMxZjk2ZmRlMGUyZGM4MTQ=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/a4562e1d-44e3-4816-967d-647fcdb17ff6?token=X19jbGRfdG9rZW5fXz1leHA9MTc3MzEwNTEyMn5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYTQ1NjJlMWQtNDRlMy00ODE2LTk2N2QtNjQ3ZmNkYjE3ZmY2Kn5obWFjPWUyZDRiMTcyZWYyM2RhODJkMjNhNTgyOWZkMDk0Zjg4ZGQ3ZjVlZjFiNzNkN2NmZTIwMmQ3M2U4MTFlZmIxYTQ=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/eed3681a-6574-4326-af28-5bcb1bcd1438?token=X19jbGRfdG9rZW5fXz1leHA9MTc3Mjg0NTkzN35hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmZWVkMzY4MWEtNjU3NC00MzI2LWFmMjgtNWJjYjFiY2QxNDM4Kn5obWFjPWI5NDNjNDliZWU5Zjc5Mzc1ZjMxNmFiODQ3YjU5MzJiNjQ0OGE4YjJlYjA1NjE2Y2U1OTNjNmI0YTIwMzcxMGE=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/b6d1979b-e15b-444b-8b83-93d5141cc591?token=X19jbGRfdG9rZW5fXz1leHA9MTc2NDM3ODczNX5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYjZkMTk3OWItZTE1Yi00NDRiLThiODMtOTNkNTE0MWNjNTkxKn5obWFjPWUwOGQwNWY4YWIyNDBkNGEwNDVjNDZiNmZkYTkzNzBiNWU3ZDZjMDExNjMwMDc5ZGVjZjExMjJiYjczOWJkMWY=&vendor=cloudinary",
	   "https://media-process.hibob.com/image/upload/q_auto:best,f_auto,a_exif,t_avatar,c_fill,w_240,h_240/hibob/avatar/327665/images/b5434987-c789-490e-9621-6071c92cd781?token=X19jbGRfdG9rZW5fXz1leHA9MTc3NzUxNTExOH5hY2w9KiUyZmhpYm9iJTJmYXZhdGFyJTJmMzI3NjY1JTJmaW1hZ2VzJTJmYjU0MzQ5ODctYzc4OS00OTBlLTk2MjEtNjA3MWM5MmNkNzgxKn5obWFjPWIwOWQyNTY5MWM4ZDQ0MTM2MmFmODFkNDkxNGZhMjczOWMwOTc3ZjQyYzRiYzM4YzY5Y2QzMWUzYjMyODIyMmU=&vendor=cloudinary"
    ],
    async loadFromEndpoint(url){
      const res = await fetch(url, {cache:'no-store'});
      if(!res.ok) throw new Error('Failed to fetch faces.json');
      const data = await res.json();
      if(Array.isArray(data)) this.images = data; else throw new Error('Endpoint must return an array of URLs');
      return this.images;
    }
  };

  const app = document.getElementById('app');
  const controls = document.getElementById('controls');
  const minFacesEl = document.getElementById('minFaces');
  const maxFacesEl = document.getElementById('maxFaces');
  const intervalEl = document.getElementById('interval');
  const shuffleBtn = document.getElementById('shuffle');
  const fsTip = document.getElementById('fsTip');

  let timer = null;
  let lastSceneEl = null;

  function randInt(min, max){return Math.floor(Math.random() * (max - min + 1)) + min}
  function sample(arr, n){
    if(n>=arr.length) return [...arr].sort(()=>Math.random()-0.5);
    const copy = [...arr]; const out=[];
    for(let i=0;i<n;i++){ const idx = Math.floor(Math.random()*copy.length); out.push(copy.splice(idx,1)[0]); }
    return out;
  }

  function randomSizeClass(i, total){
    // Bias: when few faces, include some large tiles; when many, lean small
    const p = Math.random();
    if(total <= 2) return p < .5 ? 'xl' : 'l';
    if(total <= 4) return p < .4 ? 'l' : (p < .8 ? 'm' : 'xl');
    if(total <= 8) return p < .6 ? 'm' : (p < .9 ? 's' : 'l');
    return p < .8 ? 's' : 'm';
  }

  function makeFace(url, sizeClass){
    const d = document.createElement('div');
    d.className = `face ${sizeClass} tilt${randInt(1,4)}`;
    const img = new Image();
    img.decoding = 'async';
    img.loading = 'eager';
    img.referrerPolicy = 'no-referrer';
    img.alt = '';
    img.src = url;
    d.appendChild(img);
    return d;
  }

  function newScene(){
    const min = Math.max(1, parseInt(minFacesEl.value||'1',10));
    const max = Math.max(min, parseInt(maxFacesEl.value||'9',10));
    const total = SOURCE.images.length ? randInt(min, Math.min(max, SOURCE.images.length)) : randInt(min, max);

    const scene = document.createElement('div');
    scene.className = 'scene';

    const picks = SOURCE.images.length ? sample(SOURCE.images, total) : new Array(total).fill('https://picsum.photos/seed/'+Math.random().toString(36).slice(2)+'/800/800');
    for(let i=0;i<picks.length;i++){
      const size = randomSizeClass(i, total);
      scene.appendChild(makeFace(picks[i], size));
    }

    app.appendChild(scene);
    requestAnimationFrame(()=>scene.classList.add('active'));

    if(lastSceneEl){
      const toRemove = lastSceneEl;
      setTimeout(()=>{ toRemove.remove(); }, 1200); // after crossfade
    }
    lastSceneEl = scene;
  }

  function schedule(){
    clearInterval(timer);
    const ms = Math.max(2000, parseInt(intervalEl.value||'7',10) * 1000);
    timer = setInterval(newScene, ms);
  }

  // Basic UX: show controls on key/mouse
  let cursorTimeout;
  function showControlsFor(ms=3000){
    document.documentElement.classList.add('show-cursor');
    controls.classList.add('visible');
    clearTimeout(cursorTimeout);
    cursorTimeout = setTimeout(()=>{controls.classList.remove('visible');document.documentElement.classList.remove('show-cursor');}, ms);
  }

  document.addEventListener('mousemove',()=>showControlsFor());
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){ controls.classList.toggle('visible'); document.documentElement.classList.toggle('show-cursor'); }
    if(e.key.toLowerCase() === 'f') toggleFullscreen();
    if(e.key === ' ') { e.preventDefault(); newScene(); showControlsFor(); }
  });

  shuffleBtn.addEventListener('click', ()=>{ newScene(); showControlsFor(); });
  [minFacesEl,maxFacesEl,intervalEl].forEach(el=> el.addEventListener('change', schedule));

  function toggleFullscreen(){
    if(!document.fullscreenElement){ document.documentElement.requestFullscreen().catch(()=>{}); }
    else{ document.exitFullscreen().catch(()=>{}); }
    fsTip.textContent = document.fullscreenElement? 'Press F or Esc to exit fullscreen' : '';
  }

  // Drag & Drop loader (JSON array or CSV with one URL per row)
  window.addEventListener('dragover', e=>{ e.preventDefault(); showControlsFor(5000); });
  window.addEventListener('drop', async (e)=>{
    e.preventDefault(); showControlsFor(5000);
    const file = e.dataTransfer.files[0]; if(!file) return;
    const text = await file.text();
    try{
      const arr = JSON.parse(text);
      if(Array.isArray(arr)) SOURCE.images = arr; else throw 0;
    }catch{
      // try CSV/lines
      SOURCE.images = text.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
    }
    // Ensure unique URLs
    SOURCE.images = Array.from(new Set(SOURCE.images));
    // Preload a few
    SOURCE.images.slice(0, 20).forEach(src=>{ const i=new Image(); i.src=src; });
    newScene();
  }, false);

  // Kickoff
  newScene();
  schedule();
  showControlsFor(3500);
  </script>
</body>
</html>
